<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>TrueRatr - Misleading Reviews Never Again</title>

<link rel="apple-touch-icon" sizes="57x57" href="favicons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="favicons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="favicons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="favicons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="favicons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="favicons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="favicons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="favicons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="favicons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="favicons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="favicons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicons/favicon-16x16.png">
<link rel="manifest" href="favicons/manifest.json">

<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="favicons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="assets/css/materialize.css" type="text/css" rel="stylesheet" media="screen,projection"/>
<link href="assets/css/mstyle.css" type="text/css" rel="stylesheet" media="screen,projection"/>

  <!-- Bootstrap -->
  <link rel="stylesheet" type="text/css" href="assets/css/bootstrap.css">
  <!-- Main Style -->
  <link rel="stylesheet" type="text/css" href="assets/css/main.css">
  <!-- Responsive Style -->
  <link rel="stylesheet" type="text/css" href="assets/css/responsive.css">
  <!--Icon Font-->
  <link rel="stylesheet" media="screen" href="assets/fonts/font-awesome/font-awesome.min.css" />
  <!-- Extras -->
  <link rel="stylesheet" type="text/css" href="assets/extras/animate.css">
  <!-- jQuery Load -->
  <script src="assets/js/jquery-min.js"></script>
  <!-- jQuery Load -->
  
  <script src="assets/js/wow.js"></script>
  <!-- All JS plugin Triggers -->
  <script src="assets/js/main.js"></script>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->

  <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
       <![endif]-->

<script>


function doPoll(){
    $.post('ajax/test.html', function(data) {
        alert(data);  // process results here
        setTimeout(doPoll,5000);
    });
}

function addList(obj) {
  console.log(obj)
  var ul = document.getElementById("searchList");
  var li = document.createElement("li");
  var divEleH = document.createElement("div");
  divEleH.setAttribute("class", "collapsible-header active")
  appID = obj.trackId
  divEleH.setAttribute("id", obj.trackId)

  trueRating = appID + "rating"
  positiveNum = appID + "posNum"
  totalNum = appID + "tot"
  sarcasticNum = appID + "sarcNum"

  trueRatingVal = appID + "ratingVal"
  positiveNumVal = appID + "posVal"
  totalNumVal = appID + "totVal"
  sarcasticNumVal = appID + "sarcVal"

  trueRatingLoading = appID + "ratingLoad"
  positiveNumLoading = appID + "posLoad"
  totalNumLoading = appID + "totLoad"
  sarcasticNumLoading = appID + "sarcLoad"

  posReview = appID + "pos"
  negReview = appID + "neg"
  sarcReview = appID + "sarc"
  reviewDiv = appID + "div"


  divEleH.innerHTML = "<div class='row'><div class='col s12'><div class='col l2 m3 s4'><img width='75' height='75' class='circle responsive-img' align='middle' src='"+ obj.artworkUrl+"'></div> <div class='col l10 m9 s12 left-align'><h5 style='font-size:2.0rem;font-weight:100;'> " +  obj.trackName + " </h5><a class='waves-effect blue lighten-1 btn right' style='margin-bottom:10px;margin-top:0px;margin-left:10px;'></i>TrueRating +</a><h5 style='font-size:1.2rem;font-weight:100;'> "+ obj.artistName +" </h5> <h4 style='font-size:3.5rem;font-weight:200;'> <i class='fa fa-apple fa-2x'></i>"+ obj.averageUserRating +"/5.0</h4></div></div></div>";

  var divEleB = document.createElement("div");
  divEleB.setAttribute("class", "collapsible-body");
  divEleB.innerHTML = "<blockquote>    <p class='wow fadeInDown animated'style='text-align: justify;text-justify: inter-word;'> " +obj.description.substring(0,300) + " ......" + " </p> </blockquote>  <div class='row2'> <div class='wow fadeInDown animated' id='"+reviewDiv +"' style='display:none'> <h3 class='center-align' style='color:#1565C0;font-size:18pt;font-weight:100;'> Reviews that Matter</h5>  <div class='reviewrow blue lighten-4 left-align' id='"+posReview +"'>Test </div> <div class='reviewrow left-align' id='"+negReview +"'> </div> <div class='reviewrow blue-grey lighten-4 left-align' id='"+sarcReview +"'> </div> </div> </div>  <div class='row'>    <div class='center-align'>       <div class='col s3 card-panel blue darken-3' wow fadeInLeft animated>          <div>             <h1 id= '"+ trueRating +"' style='display:none' style='color:white;font-size:2.5rem;font-weight:400;'>3.3/5.0</h4>             <div class='preloader-wrapper big active' id='"+trueRatingLoading +"'>                <div class='spinner-layer spinner-white-only'>                   <div class='circle-clipper left'>                      <div class='circle'></div>                   </div>                   <div class='gap-patch'>                      <div class='circle'></div>                   </div>                   <div class='circle-clipper right'>                      <div class='circle'></div>                   </div>                </div>             </div>             <p>TrueRatr<br>Rating</p>          </div>       </div>       <div class='col s3 card-panel blue accent-1 wow fadeInLeft animated'>          <div>             <h1 id= '"+ totalNum +"' style='display:none' style='color:#ffffff;font-size:2.5rem;font-weight:400;'>132</h4>             <div class='preloader-wrapper big active' id='"+totalNumLoading +"'>                <div class='spinner-layer spinner-white-only'>                   <div class='circle-clipper left'>                      <div class='circle'></div>                   </div>                   <div class='gap-patch'>                      <div class='circle'></div>                   </div>                   <div class='circle-clipper right'>                      <div class='circle'></div>                   </div>                </div>             </div>             <p>Reviews<br>Analyzed</p>          </div>       </div>       <div class='col s3 card-panel blue darken-3 wow fadeInRight animated'>          <div>             <h1  id= '"+ positiveNum +"' style='display:none' style='color:#ffffff;font-size:2.5rem;font-weight:400;'>34%</h4>             <div class='preloader-wrapper big active' id='"+positiveNumLoading +"'>                <div class='spinner-layer spinner-white-only'>                   <div class='circle-clipper left'>                      <div class='circle'></div>                   </div>                   <div class='gap-patch'>                      <div class='circle'></div>                   </div>                   <div class='circle-clipper right'>                      <div class='circle'></div>                   </div>                </div>             </div>             <p>Positive<br>Reviews</p>          </div>       </div>       <div class='col s3 card-panel blue accent-1 wow fadeInRight animated'>          <div>             <h1 id= '"+ sarcasticNum +"' style='display:none' style='color:#ffffff;font-size:2.5rem;font-weight:400;'>12</h4>             <div class='preloader-wrapper big active' id='"+sarcasticNumLoading +"'>                <div class='spinner-layer spinner-white-only'>                   <div class='circle-clipper left'>                      <div class='circle'></div>                   </div>                   <div class='gap-patch'>                      <div class='circle'></div>                   </div>                   <div class='circle-clipper right'>                      <div class='circle'></div>                   </div>                </div>             </div>             <p>Sarcastic<br>Reviews</p>          </div>       </div>    </div> </div>";
  li.appendChild(divEleH);
  li.appendChild(divEleB);
  li.setAttribute("id", 123); // added line
  ul.appendChild(li);
}


function redirectToSearchListing(){
  var queryTerm = document.getElementById('searchBox').value;
  window.location.href = "searchlisting.html?q="+ queryTerm;

}

function getURL(){
  var queryTerm = document.getElementById('searchBox').value;
  return "searchlisting.html?q=" + queryTerm
}

function searchApp(e) {
    var event = e || window.event;
    var charCode = event.which || event.keyCode;
    if ( charCode == '13' ) {
      var queryTerm = document.getElementById('searchBox').value;
      if(queryTerm == ""){
        alert("No Search Term Entered")
      }
      else {
        redirectToSearchListing()
      }
    }
}

function getQueryVariable(variable) {
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
    if (pair[0] == variable) {
      return pair[1];
    }
  } 
  alert('Query Variable ' + variable + ' not found');
}

renderData = function(jsonResponse){
  document.getElementById("lb").style.display = "none";
  document.getElementById("searchList").style.display = "block";
  document.getElementById("resultsIndicator").style.display = "block";
  document.getElementById("resultsIndicator").innerHTML = "Showing Results for <u>" + decodeURIComponent(getQueryVariable('q')) + "</u>. Total Number of results :" + jsonResponse.resultCount

  if(jsonResponse.resultCount > 0){
  for(var i=0;i < jsonResponse.resultCount;i++){
    addList(jsonResponse.results[i]);}
  }
else
  {
    alert("No Results found for the given search term");
    window.location.href = "trueratr.html"
  }
}


var getData = function() {
  baseurl = "https://trueratr-backend.herokuapp.com/search?q="
  queryString = getQueryVariable("q");
  url = baseurl+queryString;
  $.getJSON(url, renderData)
}

// render data
window.getData = getData;



</script>


</head>

<body onload="getData();">
  <script src="assets/js/materialize.js"></script>
  <script src="assets/js/init.js"></script>

  <!-- Nav Menu Section -->
  <div class="logo-menu">
    <nav class="navbar navbar-default">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header col-md-3">
          
          <a class="navbar-brand" href="trueratr.html" style="height:35px"> <img src="assets/img/features/Desktop.png" alt=""></a>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav pull-right">
          
          </ul>
        </div>
      </div>
    </nav>
  </div>
  <!-- Nav Menu Section End -->

  <!-- Search Bar -->
  <br>
  <div class="col-md-12 text-center" style="margin-bottom: 60px;margin-left: auto;margin-right: auto;text-align: center;">
            <div class="search-wrapper" style="width: 820px;margin: auto;">
                <input onkeyup="searchApp(event)" type="text" placeholder="Search an app" class="largetext" id="searchBox" style="width: 800px; font-size: 20px">
                <div class="search-button fa fa-search" onclick="redirectToSearchListing()"></div>
            </div>
  </div>

  <br>
  <!-- Search Bar Ends -->
  
  <div class="container" style="text-align:center"id="searchListingDiv">
  <div class="section">
  <div class="load-bar" id="lb">
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
  </div>
  <i><div id="resultsIndicator" class="left-align"style="display:none;font-size:1.5rem;font-weight:400;"> </div> </i>
  <ul id="searchList" class="collapsible popout no-bullets list-group" data-collapsible="accordion" style ="display:none">
  </ul> 
</div>
  </div>
 

</body>
</html>